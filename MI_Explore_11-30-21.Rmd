---
title: "Michigan Explore"
author: "Blain Morin"
date: "11/24/2021"
output: html_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(lubridate)
library(readr)

```

```{r}

### Treatment Data
treatments = read_csv("treatments.csv")


### Assemble 2016 - 2020 data
arr16 = readRDS("~/michigan_arrests/data/ucr_arrests_monthly_all_crimes_race_sex_2016.rds")
arr16 = arr16 %>%
  filter(state_abb == "MI") %>%
  select(fips_county_code, state, agency_name, year, month, starts_with("dui"))


arr17 = readRDS("~/michigan_arrests/data/ucr_arrests_monthly_all_crimes_race_sex_2017.rds")
arr17 = arr17 %>%
  filter(state_abb == "MI") %>%
  select(fips_county_code, state, agency_name, year, month, starts_with("dui"))


arrest = rbind(arr16, arr17)


arr18 = readRDS("~/michigan_arrests/data/ucr_arrests_monthly_all_crimes_race_sex_2018.rds")
arr18 = arr18 %>%
  filter(state_abb == "MI") %>%
  select(fips_county_code, state, agency_name, year, month, starts_with("dui"))


arrest = rbind(arrest, arr18)


arr19 = readRDS("~/michigan_arrests/data/ucr_arrests_monthly_all_crimes_race_sex_2019.rds")
arr19 = arr19 %>%
  filter(state_abb == "MI") %>%
  select(fips_county_code, state, agency_name, year, month, starts_with("dui"))


arrest = rbind(arrest, arr19)


arr20 = readRDS("~/michigan_arrests/data/ucr_arrests_monthly_all_crimes_race_sex_2020.rds")
arr20 = arr20 %>%
  filter(state_abb == "MI") %>%
  select(fips_county_code, state, agency_name, year, month, starts_with("dui"))



arrest = rbind(arrest, arr20)


### Remove to save RAM
remove(arr16, arr17, arr18, arr19, arr20)

```

```{r}

arrest1 = arrest %>%
  mutate(monthyear = paste(month, year)) %>%
  mutate(d = my(monthyear))

treatments1 = treatments %>%
  mutate(startdate = ifelse(phase == "one", "november 2017", "october 2019")) %>%
  mutate(enddate = ifelse(phase == "one", "november 2018", "september 2020")) %>%
  mutate(s = my(startdate)) %>%
  mutate(e = my(enddate))


```




```{r}

check = arr16 %>%
  filter(state_abb == "MI") %>%
  select(fips_county_code, fips_state_code, population, agency_name)

```


